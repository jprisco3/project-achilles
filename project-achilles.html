<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Project Achilles – Full Program View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050816;
      --bg-alt: #0b1020;
      --card: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56,189,248,0.12);
      --accent-strong: rgba(56,189,248,0.3);
      --border: #1f2937;
      --text: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f97373;
      --radius-lg: 14px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 45px rgba(0,0,0,0.5);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0b1220, #020617 45%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .app-container {
      max-width: 1120px;
      margin: 24px auto;
      padding: 0 16px 32px;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 12px;
    }

    .title {
      font-size: 1.35rem;
      font-weight: 700;
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      gap: 8px;
    }

    .title span {
      color: var(--accent);
    }

    .subtitle {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 260px) minmax(0, 1fr);
      gap: 18px;
    }

    @media (max-width: 800px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: linear-gradient(135deg, rgba(15,23,42,0.95), rgba(15,23,42,0.98));
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-soft);
      padding: 14px 14px 16px;
    }

    .panel h2 {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      color: var(--text-muted);
      margin: 0 0 10px;
    }

    .category-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .category-btn {
      width: 100%;
      text-align: left;
      border-radius: var(--radius-md);
      padding: 9px 10px;
      border: 1px solid transparent;
      background: rgba(15,23,42,0.9);
      color: var(--text-muted);
      font-size: 0.9rem;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease, transform 0.08s ease;
      margin-top: 4px;
    }

    .category-btn:hover {
      background: #020617;
      border-color: var(--accent-strong);
      color: var(--text);
      transform: translateY(-0.5px);
    }

    .category-btn.active {
      background: radial-gradient(circle at top left, rgba(56,189,248,0.25), rgba(15,23,42,0.98));
      border-color: var(--accent);
      color: #f9fafb;
    }

    .category-label {
      display: flex;
      flex-direction: column;
    }

    .category-title {
      font-weight: 600;
    }

    .category-subtitle {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .badge-count {
      font-size: 0.78rem;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid rgba(148,163,184,0.5);
      color: var(--text-muted);
    }

    .main-panel {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .chip {
      font-size: 0.75rem;
      border-radius: 999px;
      padding: 3px 8px;
      background: rgba(15,23,42,1);
      border: 1px solid rgba(148,163,184,0.5);
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .chip span {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .chip-ghost {
      opacity: 0.7;
    }

    .workout-header {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 4px;
    }

    .workout-title {
      font-size: 1.05rem;
      font-weight: 600;
    }

    .workout-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .badge-workout-index {
      font-size: 0.78rem;
      border-radius: 999px;
      padding: 2px 7px;
      background: rgba(15,23,42,0.95);
      border: 1px solid rgba(148,163,184,0.6);
      margin-left: 6px;
    }

    .section {
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px dashed rgba(31,41,55,0.9);
    }

    .section h3 {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-muted);
      margin: 0 0 6px;
    }

    .template-body {
      font-size: 0.9rem;
      line-height: 1.45;
      color: #e5e7eb;
      white-space: pre-line;
    }

    .last-log-card {
      background: rgba(15,23,42,0.95);
      border-radius: var(--radius-md);
      border: 1px solid rgba(31,41,55,0.9);
      padding: 8px 9px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .last-log-empty {
      color: var(--text-muted);
      font-style: italic;
    }

    .last-log-date {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .last-log-metrics {
      color: #e5e7eb;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    label {
      font-size: 0.82rem;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    input[type="date"],
    input[type="text"],
    textarea,
    select {
      background: #020617;
      border-radius: 9px;
      border: 1px solid rgba(31,41,55,0.9);
      color: var(--text);
      padding: 6px 8px;
      font-size: 0.86rem;
      font-family: inherit;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    input[type="date"]:focus,
    input[type="text"]:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56,189,248,0.4);
      background: #020617;
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    .field-inline {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .field-inline > label {
      flex: 1 1 140px;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
      align-items: center;
    }

    button {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-family: inherit;
      padding: 7px 12px;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.15s ease, transform 0.08s ease, box-shadow 0.12s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #0ea5e9, #22c55e);
      color: #0f172a;
      font-weight: 600;
      box-shadow: 0 12px 25px rgba(56,189,248,0.3);
    }

    .btn-primary:hover {
      transform: translateY(-0.5px);
      box-shadow: 0 16px 40px rgba(56,189,248,0.45);
    }

    .btn-secondary {
      background: rgba(15,23,42,0.95);
      color: var(--text-muted);
      border: 1px solid rgba(55,65,81,0.9);
    }

    .btn-secondary:hover {
      background: #020617;
      color: #e5e7eb;
    }

    .btn-danger {
      background: rgba(220,38,38,0.12);
      color: #fecaca;
      border: 1px solid rgba(248,113,113,0.5);
    }

    .btn-danger:hover {
      background: rgba(220,38,38,0.22);
    }

    .status {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .status.success {
      color: #bbf7d0;
    }

    .status.error {
      color: var(--danger);
    }

    .session-picker {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .session-picker-label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Groups / drill-through in sidebar */
    .group {
      margin-bottom: 12px;
    }

    .group-toggle {
      width: 100%;
      text-align: left;
      background: transparent;
      border: none;
      padding: 4px 2px;
      color: var(--text-muted);
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .group-toggle span.arrow {
      font-size: 0.7rem;
      opacity: 0.8;
    }

    /* Per-exercise logging UI */
    .exercise-table-container {
      margin-top: 6px;
      margin-bottom: 4px;
    }

    .exercise-table {
      border-radius: 10px;
      border: 1px solid rgba(31,41,55,0.9);
      padding: 6px 8px;
      background: #020617;
      font-size: 0.8rem;
    }

    .exercise-table-title {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .exercise-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      padding: 4px 0;
      border-top: 1px dashed rgba(55,65,81,0.6);
    }

    .exercise-row:first-of-type {
      border-top: none;
    }

    .exercise-name {
      flex: 1 1 140px;
      font-weight: 500;
      color: #e5e7eb;
    }

    .exercise-last {
      flex: 1 1 140px;
      font-size: 0.76rem;
      color: var(--text-muted);
    }

    .exercise-inputs {
      flex: 1 1 160px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .exercise-inputs input {
      width: 60px;
      font-size: 0.78rem;
      padding: 4px 6px;
    }

    .exercise-inputs input.exercise-load {
      width: 80px;
    }

    .exercise-inputs label {
      font-size: 0.75rem;
      color: var(--text-muted);
      flex-direction: column;
      gap: 2px;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <div>
        <div class="title">
          Project Achilles
          <span>Full Program View</span>
        </div>
        <div class="subtitle">
          Drill into Golf, Boxing, or General Fitness, see the next workout in that stream, and log your session.
        </div>
      </div>
    </header>

    <div class="layout">
      <aside class="panel">
        <h2>Context / Category</h2>
        <div class="category-list" id="category-list">
          <!-- Category groups & buttons injected by JS -->
        </div>
      </aside>

      <main class="panel main-panel">
        <div class="chip-row">
          <div class="chip">
            <span></span> Auto-rotates workouts per sub-category
          </div>
          <div class="chip chip-ghost">
            <span></span> Data stays in your browser (localStorage)
          </div>
        </div>

        <div id="workout-content">
          <!-- Workout details injected by JS -->
        </div>
      </main>
    </div>
  </div>

  <script>
    // ------- WORKOUT DEFINITIONS -------
    const WORKOUT_TEMPLATES = {
      boxing_class: {
        name: "Boxing – Class Schedule",
        subtitle: "Group classes by day & time",
        workouts: [
          {
            id: "boxing_class_mon_am",
            title: "Mon – 7:00–8:00 AM Class",
            description:
`Location: Boxing gym (approx. 15 min travel each way).

Use this entry to log:
• Focus of class (technique / sparring / conditioning).
• Key drills, rounds, partners.
• How you felt and what to work on next time.`
          },
          {
            id: "boxing_class_tue_am",
            title: "Tue – 7:00–8:00 AM Class",
            description:
`Location: Boxing gym.

Log what actually happened in this class:
• Warm-up drills
• Technical focus
• Sparring / bag rounds
• Any cues from coach you want to remember.`
          },
          {
            id: "boxing_class_wed_am",
            title: "Wed – 7:00–8:00 AM Class",
            description:
`Location: Boxing gym.

Use this for Wednesday morning sessions.
• Note overall focus (offense / defense / conditioning).
• Track hard rounds and key improvements.`
          },
          {
            id: "boxing_class_thu_am",
            title: "Thu – 7:00–8:00 AM Class",
            description:
`Location: Boxing gym.

Thursday morning class log.
• Capture drills, combinations, and sparring notes.
• Note anything that felt especially good or off.`
          },
          {
            id: "boxing_class_fri_am",
            title: "Fri – 7:00–8:00 AM Class",
            description:
`Location: Boxing gym.

Friday morning class log.
• End-of-week feel.
• What needs sharpening for next week.`
          },
          {
            id: "boxing_class_mon_pm",
            title: "Mon – 5:30–6:30 PM Class",
            description:
`Location: Boxing gym.

Evening class log.
• Note how energy feels after your workday.
• Log any differences vs morning sessions.`
          },
          {
            id: "boxing_class_tue_pm",
            title: "Tue – 5:30–6:30 PM Class",
            description:
`Location: Boxing gym.

Tuesday evening class log.
• Record technical focus and any hard rounds.
• Track trends in performance on back-to-back days.`
          },
          {
            id: "boxing_class_thu_pm",
            title: "Thu – 5:30–6:30 PM Class",
            description:
`Location: Boxing gym.

Thursday evening class log.
• Capture pre-weekend intensity, sparring notes, and cues.
• Good place to note what to carry into next week.`
          }
        ]
      },

      boxing_full_gym: {
        name: "Boxing – Full Gym Skill",
        subtitle: "Mini skill blocks with full boxing gym access",
        workouts: [
          {
            id: "boxing_full_1_bag_precision",
            title: "Bag Precision & Distance",
            description:
`Goal: accuracy, range control, clean mechanics.

Round 1 – Jab Targets (3 min)
• Pick 3 visual targets on the bag (high/mid/body).
• Only jabs. Every jab snaps cleanly to a target.

Round 2 – 1–2 & 1–2–3 (3 min)
• Alternate 1–2 and 1–2–3.
• After each combo: small step out or pivot, reset stance and distance.

Round 3 – Touch–Touch–Sit (3 min)
• Two light set-up shots, one committed shot (cross or hook).
• Focus on balance and hip rotation, not max power.

Optional (1–2 min): Slow, perfect 1–2s on the bag, exaggerating form.`
          },
          {
            id: "boxing_full_2_defense_counters",
            title: "Defense & Counters (Bag + Mirror)",
            description:
`Goal: automatic defense tied directly to counters.

Round 1 – Pure Defense (3 min)
• Mirror or wall.
• Slips, rolls, parries, high guard, pull-back. No punches.

Round 2 – Slip–Counter (3 min)
• On the bag.
• Slip “jab” → jab–cross.
• Slip “cross” → hook–cross. Smooth and controlled.

Round 3 – Roll–Counter (3 min)
• On the bag.
• Roll under “hooks” → body/head combo on exit.

Optional (1–2 min): Light defensive shadowboxing in front of mirror.`
          },
          {
            id: "boxing_full_3_ring_craft",
            title: "Ring Craft & Positioning",
            description:
`Goal: better feel for space, corners, ropes, and controlling the ring.

Round 1 – Corner Escapes (3 min)
• Start in a corner.
• Practice pivoting out, stepping off at angles, never backing straight up more than 2–3 steps.

Round 2 – Cutting Off the Ring (3 min)
• Imagine an opponent circling away.
• Move on diagonals to cut them off, stay just outside punching range.
• Add simple 1–2 entries once you “trap” them.

Round 3 – Ring + Bag Flow (3 min)
• Start at center, move to the bag like it’s an opponent on the ropes.
• Short controlled combos, angle out, circle back to center, repeat.`
          }
        ]
      },

      boxing_any_gym: {
        name: "Boxing – Any Gym Skill",
        subtitle: "Skill work at a regular/office gym",
        workouts: [
          {
            id: "boxing_any_4_mirror_technique",
            title: "Mirror Technique Shadowboxing",
            description:
`Goal: tighten form, posture, and coordination.

Round 1 – Stance & Guard (3 min)
• In front of the mirror.
• Fix stance width, weight distribution, hand position.
• Slow punches; pause at full extension and check alignment.

Round 2 – Single Weapon Focus (3 min)
• Choose jab or cross for the whole round.
• Vary level, angle, and rhythm while keeping mechanics perfect.

Round 3 – Simple Combos (3 min)
• 3–4 combos only (e.g., 1–2, 1–2–3, 1–2–3–2).
• Move your feet after every combo (step out, pivot, or slide).

Optional (2–3 min): Ultra-slow full-body shadowboxing, focusing on balance and sequencing.`
          },
          {
            id: "boxing_any_5_footwork_lines",
            title: "Footwork Lines & Angles",
            description:
`Goal: cleaner foot placement, balance, and angle creation.

Use floor lines (tiles, seams) or tape a line.

Drill 1 – Line Walk (2–3 min)
• Walk up and down the line in stance.
• Keep lead and rear foot on either side of the line, smooth and balanced.

Drill 2 – In–Out–Side (4–5 min)
• From the line center: step in, step out, step left, step right, always returning to stance.
• Add 1–2 when you step in, hands up on the way out.

Drill 3 – Angle Steps (3–4 min)
• Step in with a combo, then pivot 45–90° off the line.
• Practice both directions, eyes always on an “opponent.”`
          }
        ]
      },

      boxing_anywhere: {
        name: "Boxing – Anywhere Skill",
        subtitle: "Skill work with zero equipment",
        workouts: [
          {
            id: "boxing_anywhere_6_cognitive_shadow",
            title: "Cognitive & Pattern Shadowboxing",
            description:
`Goal: pattern recognition, decision-making, smooth combos.

Round 1 – Call-Out Combos (3 min)
• Choose 2–3 combos (e.g., 1–2, 1–2–3, 2–3–2).
• In your head, “call” which combo you’ll throw before you throw it.
• Focus on sharp start–stop and balance.

Round 2 – Defense-First Flow (3 min)
• Every action starts with defense: slip, roll, parry, or step.
• Then add a short combo off that defensive move.

Round 3 – Visualized Opponent (3 min)
• Imagine an opponent: their guard, reactions, and openings.
• Mix feints, jabs, and movement; avoid mindless flurries.

Optional (2–3 min): Slow-motion replay of 1–2 “best exchanges” from the round.`
          }
        ]
      },

      strength: {
        name: "Strength",
        subtitle: "Two alternating strength sessions",
        workouts: [
          {
            id: "strength_a_lower_pull_rotate",
            title: "Strength A – Lower / Pull / Rotate",
            description:
`Goal: build lower body strength, pulling power, and rotational force.

Main Blocks
• Trap-bar Deadlift or RDL – 3–5 × 3–6
• Split Squat or Step-Up – 3 × 6–8 per leg
• Pull-Ups or Heavy Row – 3–4 × 5–8

Power / Core
• Med-Ball Rotational Throws – 4 × 5 per side
• Farmer Carry – 3 × 30–45 sec

Notes
• Rest 90–150 sec between heavy sets.
• Focus on crisp reps, not grinding to failure.`,
            exercises: [
              {
                id: "strengthA_deadlift",
                name: "Trap-bar Deadlift or RDL",
                defaultSets: "3–5",
                defaultReps: "3–6",
                defaultUnit: "lb"
              },
              {
                id: "strengthA_split_squat",
                name: "Split Squat or Step-Up",
                defaultSets: "3",
                defaultReps: "6–8/leg",
                defaultUnit: "lb"
              },
              {
                id: "strengthA_pull",
                name: "Pull-Ups or Heavy Row",
                defaultSets: "3–4",
                defaultReps: "5–8",
                defaultUnit: "lb or bw"
              },
              {
                id: "strengthA_medball",
                name: "Med-Ball Rotational Throws",
                defaultSets: "4",
                defaultReps: "5/side",
                defaultUnit: "lb"
              },
              {
                id: "strengthA_farmers",
                name: "Farmer Carry",
                defaultSets: "3",
                defaultReps: "30–45s",
                defaultUnit: "lb/hand"
              }
            ]
          },
          {
            id: "strength_b_upper_push_antirotate",
            title: "Strength B – Upper / Push / Anti-Rotate",
            description:
`Goal: upper body strength, power, and anti-rotation stability.

Main Blocks
• Bench Press or Weighted Push-Ups – 3–5 × 3–6
• Landmine Press – 3 × 6–8 per side
• Single-Leg RDL – 3 × 6–8 per leg

Core / Prehab
• Pallof Press (Anti-Rotation) – 3 × 8–12 per side
• Neck + Shoulder Prehab Superset – 2–3 easy rounds
  - Choose simple movements (band external rotations, YTWs, neck nods, etc.)

Notes
• Rest 90–150 sec between heavy sets.
• Keep power reps snappy; stop set if speed drops.`,
            exercises: [
              {
                id: "strengthB_bench",
                name: "Bench Press or Weighted Push-Ups",
                defaultSets: "3–5",
                defaultReps: "3–6",
                defaultUnit: "lb"
              },
              {
                id: "strengthB_landmine",
                name: "Landmine Press",
                defaultSets: "3",
                defaultReps: "6–8/side",
                defaultUnit: "lb"
              },
              {
                id: "strengthB_slRDL",
                name: "Single-Leg RDL",
                defaultSets: "3",
                defaultReps: "6–8/leg",
                defaultUnit: "lb"
              },
              {
                id: "strengthB_pallof",
                name: "Pallof Press",
                defaultSets: "3",
                defaultReps: "8–12/side",
                defaultUnit: "lb"
              },
              {
                id: "strengthB_prehab",
                name: "Neck & Shoulder Prehab",
                defaultSets: "2–3",
                defaultReps: "easy",
                defaultUnit: ""
              }
            ]
          }
        ]
      },

      conditioning: {
        name: "Conditioning",
        subtitle: "Fight-pace intervals and easy Zone 2",
        workouts: [
          {
            id: "cond_fight_pace",
            title: "Conditioning – Fight Pace",
            description:
`Goal: boxing-specific high-intensity conditioning.

Option 1 – Bag Intervals
• 8–10 × 2–3 min hard bag rounds
• 1 min rest between rounds
• Alternate focus: power round, speed round, defense-focused round

Option 2 – Bike/Run Intervals
• 6–8 × 60–90 sec at RPE 8–9
• 60–90 sec easy recovery between efforts

Notes
• You should still be in control of technique.
• If form breaks down badly, cut the session.`
          },
          {
            id: "cond_zone2",
            title: "Conditioning – Zone 2 (Steady State)",
            description:
`Goal: aerobic base, recovery, and weight control.

• 30–45 min of:
  - Easy run, brisk walk, bike, or rower
• Intensity:
  - RPE ~4–5 (you can hold a conversation)
• Keep breathing relaxed, posture tall, and strides/smooth pedal strokes.

Notes
• This should feel sustainable, not like a workout you have to survive.`
          }
        ]
      },

      golf_range: {
        name: "Golf – Range Session",
        subtitle: "Longer range sessions to rotate through",
        workouts: [
          {
            id: "golf_range_1_contact_startline",
            title: "Range 1 – Contact & Start Line",
            description:
`Goal: solid contact + ball starting near your target line.

Warm-Up (5–10 min)
• 10–15 half swings with a wedge to a close target.
• Balanced finish, centered contact, smooth tempo.

Contact Drill – “3-Station Wedge” (10–15 min)
• With wedge or 9-iron, hit 3–5 balls each to:
  - Short carry target
  - Medium carry target
  - Slightly longer carry target
• Focus on strike quality, not max distance.

Start Line Drill – “Stick Down” (10–15 min)
• Lay an alignment stick/club on the ground pointing at target.
• Hit 15–20 balls; watch if ball starts along that line.
• Ignore curvature; just start direction.

Finish – 9-Ball Contact Block (10–15 min)
• One short iron.
• Hit 9 balls, aiming for 7/9 solid strikes.
• After a mis-hit, rehearse 1–2 slow swings before next ball.`
          },
          {
            id: "golf_range_2_direction_curvature",
            title: "Range 2 – Direction & Curvature",
            description:
`Goal: control where the ball starts and which way it curves.

Warm-Up (5–10 min)
• 10 wedges/9-irons with smooth tempo, focus on start line.

Start Line + Gate Drill (10–15 min)
• Create a gate 2–3 feet in front of you with two tees/objects.
• Hit 15–20 balls trying to send the ball through the gate.

Curvature Drill – 3 Patterns (15–20 min)
• With a mid-iron:
  - 5 balls trying a gentle fade.
  - 5 balls trying a gentle draw.
  - 5 balls aiming straight (accept slight curve).
• Notice what grip/face/feel produces each curve.

Finish – 9-Shot Window (9–12 min)
• Single target:
  - 3 balls: fade to target
  - 3 balls: draw to target
  - 3 balls: straight as you can
• Note which pattern feels most natural = your “stock shot.”`
          },
          {
            id: "golf_range_3_distance_planning",
            title: "Range 3 – Distance & Shot Planning",
            description:
`Goal: own a stock shot + better distance and decision-making.

Warm-Up (5–10 min)
• 10 mixed wedges/short irons, easy tempo.

Distance Ladder – 3 Clubs (15–20 min)
• Choose 3 clubs (e.g., PW, 7-iron, hybrid).
• For each club:
  - Hit 5 balls trying to carry to the same distance.
  - Focus on consistent trajectory and contact.

Random Target Drill (15–20 min)
• Treat range like a course.
• For each ball:
  - Pick a specific target.
  - Choose the club you'd use on-course.
  - Full pre-shot routine, then hit.

Finish – Simulated 3-Hole Stretch (10–15 min)
• Imagine 3 holes:
  - For each: tee shot club → “approach” club → “chip/wedge”.
• Hit in sequence with full routine for each shot.`
          }
        ]
      },

      golf_micro: {
        name: "Golf – Micro Practice",
        subtitle: "10–20 minute blocks at home/office",
        workouts: [
          {
            id: "golf_micro_1_putt_startline",
            title: "Micro 1 – Putting Start Line",
            description:
`Goal: roll the ball where you’re aimed.

• Set a start line gate: two tees/objects just wider than a ball, 1–2 ft ahead.
• Hit 20–30 putts from 3–6 ft.
• Ball must pass cleanly through the gate.
• Focus on square face at impact and solid strike.`
          },
          {
            id: "golf_micro_2_putt_speed",
            title: "Micro 2 – Putting Speed / Distance",
            description:
`Goal: better pace control on longer putts.

• On a mat/carpet, mark 3 distances (e.g., short/mid/long).
• Hit 5 balls to each distance, trying to stop inside a small zone.
• Then ladder drill: each putt slightly farther than the last, staying within your defined “speed window.”`
          },
          {
            id: "golf_micro_3_chip_landing",
            title: "Micro 3 – Chip/Pitch Contact & Landing",
            description:
`Goal: clean strike and predictable first bounce.

• On carpet or safe area (foam or real balls if safe).
• Choose a landing spot (towel, small object) a few feet ahead.
• Hit ~20 mini chips, focusing on brushing the ground in the same place.
• Watch if the ball consistently lands near that spot.`
          },
          {
            id: "golf_micro_4_slowmo_swing",
            title: "Micro 4 – Swing Mechanics Slow-Mo",
            description:
`Goal: improve positions without ball pressure.

• Use mirror/window; hold a club.
• 5–10 rehearsal swings to checkpoints:
  - Setup posture
  - Club halfway back
  - Top of backswing
• Then 10–15 slow-motion full swings at ~20–50% speed.
• Pause at positions to check balance, face, shoulder/hip turn.`
          },
          {
            id: "golf_micro_5_grip_setup",
            title: "Micro 5 – Grip & Setup Calibration",
            description:
`Goal: make a consistent setup automatic.

• In a mirror:
  - Take your grip 10–15 times, checking hand placement and clubface square.
• Build full address position 10–15 times:
  - Stance width, ball position, spine tilt, weight distribution.
• After each, make a small swing to waist-high and back to address in balance.`
          },
          {
            id: "golf_micro_6_preshot_routine",
            title: "Micro 6 – Pre-Shot Routine & Visualization",
            description:
`Goal: build a reliable on-course routine.

• With or without a ball, pick a “target” in the room or outside.
• For 10–15 reps:
  - Choose target and shot shape.
  - Visualize ball flight.
  - Practice swing with that feel.
  - Step in, align, and execute a full or half swing.
• Keep number of looks and tempo consistent.`
          }
        ]
      },

      mobility: {
        name: "Mobility",
        subtitle: "Two simple sessions to alternate",
        workouts: [
          {
            id: "mobility_a_hips_ankles_tspine",
            title: "Mobility A – Hips, Ankles, T-Spine",
            description:
`Total: ~15–20 min.

Hips & Glutes (5–6 min)
• 90/90 Hip Switches – 2×8 each side
• Glute Bridge with Reach – 2×10 (alternate arms)

Adductors & Hamstrings (3–4 min)
• Cossack Squats – 2×6 each side
• Hamstring Scoops / Toe Touch Walks – 1–2 passes of 10–12 steps

Ankles (3–4 min)
• Knee-to-Wall Dorsiflexion – 2×8 each side
• Ankle Circles – 1×10 each direction per ankle

T-Spine Rotation (3–4 min)
• Open Books – 2×8 each side
• Quadruped T-Spine Rotations – 1×8 each side`
          },
          {
            id: "mobility_b_shoulders_rotation",
            title: "Mobility B – Shoulders, Rotation, Stability",
            description:
`Total: ~15–20 min.

Shoulders & Upper Back (5–6 min)
• Wall Slides – 2×10
• Scap Push-Ups – 2×10 (plank or knees)

Thoracic & Ribcage (3–4 min)
• Cat–Cow – 1×10 slow reps
• Thread the Needle – 2×6 each side

Neck & Wrists (3–4 min)
• Neck Controlled Tilts & Turns – 1×5 each direction
• Wrist Extensions/Flexions on Floor – 2×8 each direction

Balance & Core Control (3–4 min)
• Single-Leg Balance with Reach – 2×5 each leg
• Side Plank or Copenhagen Hold – 2×20–30 sec each side`
          }
        ]
      }
    };

    // ------- GROUPS FOR SIDEBAR (DRILL-THROUGH) -------
    const CATEGORY_GROUPS = [
      {
        id: "boxing",
        label: "Boxing",
        categories: [
          "boxing_class",
          "boxing_full_gym",
          "boxing_any_gym",
          "boxing_anywhere"
        ]
      },
      {
        id: "golf",
        label: "Golf",
        categories: [
          "golf_range",
          "golf_micro"
        ]
      },
      {
        id: "general_fitness",
        label: "General Fitness",
        categories: [
          "strength",
          "conditioning",
          "mobility"
        ]
      }
    ];

    // ------- STATE & STORAGE -------
    const STORAGE_KEY = "trainingTrackerState_v3";

    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) {
          return { currentIndex: {}, logs: {} };
        }
        const parsed = JSON.parse(raw);
        return {
          currentIndex: parsed.currentIndex || {},
          logs: parsed.logs || {}
        };
      } catch (e) {
        console.error("Failed to load state:", e);
        return { currentIndex: {}, logs: {} };
      }
    }

    function saveState(state) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    let appState = loadState();
    let selectedCategoryId = null;
    let selectedGroupId = CATEGORY_GROUPS[0]?.id || null;

    // ------- RENDERING -------
    function createCategoryButtons() {
      const container = document.getElementById("category-list");
      container.innerHTML = "";

      CATEGORY_GROUPS.forEach(group => {
        const groupDiv = document.createElement("div");
        groupDiv.className = "group";

        const headerBtn = document.createElement("button");
        headerBtn.type = "button";
        headerBtn.className = "group-toggle";

        const isExpanded = selectedGroupId === group.id;
        const arrowSpan = document.createElement("span");
        arrowSpan.className = "arrow";
        arrowSpan.textContent = isExpanded ? "▾" : "▸";

        const labelSpan = document.createElement("span");
        labelSpan.textContent = group.label.toUpperCase();

        headerBtn.appendChild(arrowSpan);
        headerBtn.appendChild(labelSpan);

        headerBtn.addEventListener("click", () => {
          selectedGroupId = group.id;
          const groupCats = group.categories.filter(id => WORKOUT_TEMPLATES[id]);
          if (groupCats.length) {
            if (!selectedCategoryId || !groupCats.includes(selectedCategoryId)) {
              selectedCategoryId = groupCats[0];
            }
          } else {
            selectedCategoryId = null;
          }
          createCategoryButtons();
          renderWorkoutContent();
        });

        groupDiv.appendChild(headerBtn);

        if (isExpanded) {
          group.categories.forEach(catId => {
            const cat = WORKOUT_TEMPLATES[catId];
            if (!cat) return;

            const btn = document.createElement("button");
            btn.className = "category-btn";
            if (selectedCategoryId === catId) {
              btn.classList.add("active");
            }
            btn.dataset.categoryId = catId;

            const label = document.createElement("div");
            label.className = "category-label";

            const title = document.createElement("div");
            title.className = "category-title";
            title.textContent = cat.name;

            const subtitle = document.createElement("div");
            subtitle.className = "category-subtitle";
            subtitle.textContent = cat.subtitle;

            label.appendChild(title);
            label.appendChild(subtitle);

            const countBadge = document.createElement("div");
            countBadge.className = "badge-count";
            countBadge.textContent = `${cat.workouts.length} workouts`;

            btn.appendChild(label);
            btn.appendChild(countBadge);

            btn.addEventListener("click", () => {
              selectedCategoryId = catId;
              document
                .querySelectorAll(".category-btn")
                .forEach(b => b.classList.remove("active"));
              btn.classList.add("active");
              renderWorkoutContent();
            });

            groupDiv.appendChild(btn);
          });
        }

        container.appendChild(groupDiv);
      });
    }

    function renderWorkoutContent(statusMessage = "", statusType = "") {
      const container = document.getElementById("workout-content");
      container.innerHTML = "";

      if (!selectedCategoryId) {
        container.innerHTML = `
          <div class="workout-header">
            <div class="workout-title">Select a category to begin</div>
            <div class="workout-meta">
              1) Click a top-level group (Boxing / Golf / General Fitness).<br>
              2) Choose a sub-category (e.g., Golf – Range Session).<br>
              3) Run the next workout and log it here.
            </div>
          </div>
        `;
        return;
      }

      const category = WORKOUT_TEMPLATES[selectedCategoryId];
      const workouts = category.workouts;

      if (!workouts || !workouts.length) {
        container.innerHTML = `<div>No workouts defined for this category.</div>`;
        return;
      }

      const idx = appState.currentIndex[selectedCategoryId] ?? 0;
      const safeIdx = Math.min(Math.max(idx, 0), workouts.length - 1);
      const workout = workouts[safeIdx];

      const logs = appState.logs[workout.id] || [];
      const lastLog = logs.length ? logs[logs.length - 1] : null;
      const todayStr = new Date().toISOString().slice(0, 10);

      const lastExerciseValues = {};
      if (lastLog && lastLog.exercises) {
        Object.entries(lastLog.exercises).forEach(([exId, data]) => {
          lastExerciseValues[exId] = data;
        });
      }

      const wrapper = document.createElement("div");

      const header = document.createElement("div");
      header.className = "workout-header";
      header.innerHTML = `
        <div class="workout-title">
          ${workout.title}
          <span class="badge-workout-index">Workout ${safeIdx + 1} of ${workouts.length}</span>
        </div>
        <div class="workout-meta">
          Category: ${category.name}
        </div>
      `;
      wrapper.appendChild(header);

      // Session picker
      if (workouts.length > 1) {
        const picker = document.createElement("div");
        picker.className = "session-picker";
        picker.innerHTML = `
          <div class="session-picker-label">Session in this category:</div>
        `;
        const select = document.createElement("select");
        workouts.forEach((w, i) => {
          const opt = document.createElement("option");
          opt.value = i;
          opt.textContent = `${i + 1}. ${w.title}`;
          if (i === safeIdx) opt.selected = true;
          select.appendChild(opt);
        });
        select.addEventListener("change", () => {
          const newIdx = parseInt(select.value, 10);
          appState.currentIndex[selectedCategoryId] = newIdx;
          saveState(appState);
          renderWorkoutContent("Switched to selected workout.", "success");
        });
        picker.appendChild(select);
        wrapper.appendChild(picker);
      }

      // Template
      const templateSection = document.createElement("div");
      templateSection.className = "section";
      templateSection.innerHTML = `
        <h3>Template</h3>
        <div class="template-body">${escapeHtml(workout.description).replace(/\n/g, "<br>")}</div>
      `;
      wrapper.appendChild(templateSection);

      // Last log
      const lastLogSection = document.createElement("div");
      lastLogSection.className = "section";
      lastLogSection.innerHTML = `<h3>Last Session</h3>`;
      const lastLogCard = document.createElement("div");
      lastLogCard.className = "last-log-card";

      if (!lastLog) {
        lastLogCard.innerHTML = `<div class="last-log-empty">No log yet for this specific workout. Your first entry here will become the baseline.</div>`;
      } else {
        const dateText = new Date(lastLog.date).toLocaleDateString([], {
          year: "numeric",
          month: "short",
          day: "numeric"
        });

        let exerciseSummaryHtml = "";
        if (workout.exercises && workout.exercises.length && lastLog.exercises) {
          exerciseSummaryHtml += `<br><strong>Last per-exercise values:</strong><br>`;
          workout.exercises.forEach(ex => {
            const v = lastLog.exercises[ex.id];
            if (!v) return;
            const sets = v.sets || "-";
            const reps = v.reps || "-";
            const load = v.load || "";
            const loadText = load ? ` @ ${escapeHtml(load)}` : "";
            exerciseSummaryHtml += `${escapeHtml(ex.name)}: ${escapeHtml(sets)} × ${escapeHtml(reps)}${loadText}<br>`;
          });
        }

        lastLogCard.innerHTML = `
          <div class="last-log-date">Last done: ${dateText}</div>
          <div class="last-log-metrics">
            ${lastLog.metrics ? `<strong>Metrics / Key numbers:</strong><br>${escapeHtml(lastLog.metrics).replace(/\n/g, "<br>")}<br><br>` : ""}
            ${lastLog.notes ? `<strong>Notes:</strong><br>${escapeHtml(lastLog.notes).replace(/\n/g, "<br>")}` : ""}
            ${exerciseSummaryHtml}
          </div>
        `;
      }

      lastLogSection.appendChild(lastLogCard);
      wrapper.appendChild(lastLogSection);

      // Log form
      const logSection = document.createElement("div");
      logSection.className = "section";
      logSection.innerHTML = `<h3>Log This Session</h3>`;

      const form = document.createElement("form");
      form.innerHTML = `
        <div class="field-inline">
          <label>
            Date
            <input type="date" name="date" value="${todayStr}">
          </label>
          <label>
            Effort / RPE (optional)
            <select name="rpe">
              <option value="">--</option>
              <option value="6">6 - Easy</option>
              <option value="7">7 - Comfortable hard</option>
              <option value="8">8 - Hard</option>
              <option value="9">9 - Very hard</option>
              <option value="10">10 - Maximal</option>
            </select>
          </label>
        </div>
        <div class="exercise-table-container"></div>
        <label>
          Metrics / Key numbers
          <input type="text" name="metrics" placeholder="e.g., rounds, sets × reps, distances, quality rating...">
        </label>
        <label>
          Notes
          <textarea name="notes" placeholder="Technical feels, what improved, what to focus on next time..."></textarea>
        </label>
      `;

      // Build per-exercise fields if defined
      const exContainer = form.querySelector(".exercise-table-container");
      if (exContainer && workout.exercises && workout.exercises.length) {
        const table = document.createElement("div");
        table.className = "exercise-table";

        const title = document.createElement("div");
        title.className = "exercise-table-title";
        title.textContent = "Per-exercise sets / reps / load";
        table.appendChild(title);

        workout.exercises.forEach(ex => {
          const row = document.createElement("div");
          row.className = "exercise-row";

          const nameDiv = document.createElement("div");
          nameDiv.className = "exercise-name";
          nameDiv.textContent = ex.name;

          const lastDiv = document.createElement("div");
          lastDiv.className = "exercise-last";
          const last = lastExerciseValues[ex.id];
          if (last) {
            const sets = last.sets || "-";
            const reps = last.reps || "-";
            const load = last.load || "";
            const loadText = load ? ` @ ${last.load}` : "";
            lastDiv.textContent = `Last: ${sets} × ${reps}${loadText}`;
          } else {
            lastDiv.textContent = "Last: —";
          }

          const inputsDiv = document.createElement("div");
          inputsDiv.className = "exercise-inputs";

          const setsLabel = document.createElement("label");
          setsLabel.textContent = "Sets";
          const setsInput = document.createElement("input");
          setsInput.type = "text";
          setsInput.name = `ex_${ex.id}_sets`;
          setsInput.placeholder = ex.defaultSets || "";
          if (last && last.sets) setsInput.value = last.sets;
          setsLabel.appendChild(setsInput);

          const repsLabel = document.createElement("label");
          repsLabel.textContent = "Reps";
          const repsInput = document.createElement("input");
          repsInput.type = "text";
          repsInput.name = `ex_${ex.id}_reps`;
          repsInput.placeholder = ex.defaultReps || "";
          if (last && last.reps) repsInput.value = last.reps;
          repsLabel.appendChild(repsInput);

          const loadLabel = document.createElement("label");
          loadLabel.textContent = "Load";
          const loadInput = document.createElement("input");
          loadInput.type = "text";
          loadInput.name = `ex_${ex.id}_load`;
          loadInput.className = "exercise-load";
          loadInput.placeholder = ex.defaultUnit || "";
          if (last && last.load) loadInput.value = last.load;
          loadLabel.appendChild(loadInput);

          inputsDiv.appendChild(setsLabel);
          inputsDiv.appendChild(repsLabel);
          inputsDiv.appendChild(loadLabel);

          row.appendChild(nameDiv);
          row.appendChild(lastDiv);
          row.appendChild(inputsDiv);

          table.appendChild(row);
        });

        exContainer.appendChild(table);
      } else if (exContainer) {
        exContainer.remove();
      }

      const buttonRow = document.createElement("div");
      buttonRow.className = "button-row";

      const saveButton = document.createElement("button");
      saveButton.type = "submit";
      saveButton.className = "btn-primary";
      saveButton.textContent = "Save & Rotate to Next";

      const skipButton = document.createElement("button");
      skipButton.type = "button";
      skipButton.className = "btn-secondary";
      skipButton.textContent = "Skip Without Logging";

      const resetCategoryButton = document.createElement("button");
      resetCategoryButton.type = "button";
      resetCategoryButton.className = "btn-danger";
      resetCategoryButton.textContent = "Reset Category Cycle";

      buttonRow.appendChild(saveButton);
      buttonRow.appendChild(skipButton);
      buttonRow.appendChild(resetCategoryButton);

      const statusSpan = document.createElement("div");
      statusSpan.className = "status";
      if (statusMessage) {
        statusSpan.textContent = statusMessage;
        if (statusType) statusSpan.classList.add(statusType);
      }

      logSection.appendChild(form);
      logSection.appendChild(buttonRow);
      logSection.appendChild(statusSpan);

      wrapper.appendChild(logSection);

      container.appendChild(wrapper);

      // Handlers
      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const date = formData.get("date") || todayStr;
        const rpe = formData.get("rpe") || "";
        const metrics = formData.get("metrics") || "";
        const notes = formData.get("notes") || "";

        const exercisesLog = {};
        if (workout.exercises && workout.exercises.length) {
          workout.exercises.forEach(ex => {
            const sets = formData.get(`ex_${ex.id}_sets`) || "";
            const reps = formData.get(`ex_${ex.id}_reps`) || "";
            const load = formData.get(`ex_${ex.id}_load`) || "";
            if (sets || reps || load) {
              exercisesLog[ex.id] = { sets, reps, load };
            }
          });
        }

        const logEntry = {
          date,
          rpe,
          metrics,
          notes
        };
        if (Object.keys(exercisesLog).length) {
          logEntry.exercises = exercisesLog;
        }

        const logsForWorkout = appState.logs[workout.id] || [];
        logsForWorkout.push(logEntry);
        appState.logs[workout.id] = logsForWorkout;

        const nextIdx = (safeIdx + 1) % workouts.length;
        appState.currentIndex[selectedCategoryId] = nextIdx;

        saveState(appState);
        renderWorkoutContent("Session saved. Rotated to next workout.", "success");
      });

      skipButton.addEventListener("click", () => {
        const nextIdx = (safeIdx + 1) % workouts.length;
        appState.currentIndex[selectedCategoryId] = nextIdx;
        saveState(appState);
        renderWorkoutContent("Skipped logging. Rotated to next workout.", "success");
      });

      resetCategoryButton.addEventListener("click", () => {
        if (!confirm("Reset this category's cycle back to the first workout? Logs will be kept.")) {
          return;
        }
        appState.currentIndex[selectedCategoryId] = 0;
        saveState(appState);
        renderWorkoutContent("Category cycle reset to first workout.", "success");
      });
    }

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    // ------- INIT -------
    createCategoryButtons();
    renderWorkoutContent();
  </script>
</body>
</html>
